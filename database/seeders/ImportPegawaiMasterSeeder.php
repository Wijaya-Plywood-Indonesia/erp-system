<?php

namespace Database\Seeders;

use Illuminate\Database\Seeder;
use App\Models\Pegawai;
use Carbon\Carbon;

class ImportPegawaiMasterSeeder extends Seeder
{
    public function run()
    {
        // DATA TERBARU BERDASARKAN GAMBAR (8001 - 9252)
        $dataMaster = [
            ['8001', 'Lilis', 'P', '0000-00-00'],
            ['8002', 'Faril', 'L', '0000-00-00'],
            ['8003', 'Antonio', 'L', '0000-00-00'],
            ['8004', 'F Rozi', 'L', '0000-00-00'],
            ['8005', 'Widi', 'P', '0000-00-00'],
            ['8006', 'Yunita', 'P', '0000-00-00'],
            ['8007', 'Aminah', 'P', '0000-00-00'],
            ['8008', 'Musyrifa', 'P', '0000-00-00'],
            ['8009', 'Agus Tiya', 'L', '0000-00-00'],
            ['8010', 'Aini', 'P', '0000-00-00'],
            ['8011', 'Sahri', 'L', '0000-00-00'],
            ['8012', 'Husen', 'L', '0000-00-00'],
            ['8013', 'Dotul', 'P', '0000-00-00'],
            ['8014', 'Siti khani', 'P', '0000-00-00'],
            ['8015', 'Juwanti', 'P', '0000-00-00'],
            ['8016', 'Fitri', 'P', '0000-00-00'],
            ['8017', 'Wildan', 'L', '0000-00-00'],
            ['8018', 'Evi', 'P', '0000-00-00'],
            ['8019', 'Laila', 'P', '0000-00-00'],
            ['8020', 'Abdul', 'L', '0000-00-00'],
            ['8021', 'Mutto', 'L', '0000-00-00'],
            ['8022', 'Ariska', 'P', '0000-00-00'],
            ['8023', 'Fatih', 'L', '0000-00-00'],
            ['8024', 'Anita', 'P', '0000-00-00'],
            ['8025', 'Widi', 'P', '0000-00-00'],
            ['8026', 'Ponia', 'P', '0000-00-00'],
            ['8027', 'Dana', 'L', '0000-00-00'],
            ['8028', 'Siti', 'P', '0000-00-00'],
            ['8029', 'Anwar', 'L', '0000-00-00'],
            ['8030', 'Idris', 'L', '0000-00-00'],
            ['8031', 'Fuandi', 'L', '0000-00-00'],
            ['8032', 'Fenta', 'P', '0000-00-00'],
            ['8033', 'Yuni', 'P', '0000-00-00'],
            ['8034', 'Navi', 'P', '0000-00-00'],
            ['8035', 'Agus teguh', 'L', '0000-00-00'],
            ['9101', 'Faza', 'P', '0000-00-00'],
            ['9102', 'ulis', 'P', '0000-00-00'],
            ['9103', 'elok', 'P', '0000-00-00'],
            ['9104', 'Reni', 'P', '0000-00-00'],
            ['9105', 'Supri', 'L', '0000-00-00'],
            ['9106', 'Lastriyan', 'P', '0000-00-00'],
            ['9107', 'Soliha', 'P', '0000-00-00'],
            ['9108', 'Inul', 'P', '0000-00-00'],
            ['9109', 'Endang', 'P', '0000-00-00'],
            ['9110', '', 'P', '0000-00-00'], // Kosong
            ['9111', 'siti', 'P', '0000-00-00'],
            ['9112', 'Umi kulsu', 'P', '0000-00-00'],
            ['9113', 'Ninik', 'P', '0000-00-00'],
            ['9114', 'Sulistiani', 'P', '0000-00-00'],
            ['9115', 'Efendi', 'L', '0000-00-00'],
            ['9116', 'Rohma', 'P', '0000-00-00'],
            ['9117', 'Soliatun', 'P', '0000-00-00'],
            ['9118', 'Ayu Ohoi', 'P', '0000-00-00'],
            ['9119', 'Nur H', 'P', '0000-00-00'],
            ['9120', 'Endang m', 'P', '0000-00-00'],
            ['9121', 'Ani', 'P', '0000-00-00'],
            ['9122', 'Uut', 'P', '0000-00-00'],
            ['9123', 'wati', 'P', '0000-00-00'],
            ['9124', 'Romlah', 'P', '0000-00-00'],
            ['9125', 'lisa', 'P', '0000-00-00'],
            ['9126', 'Dona', 'P', '0000-00-00'],
            ['9127', 'Rusiat', 'P', '0000-00-00'],
            ['9128', 'Maulidia', 'P', '0000-00-00'],
            ['9129', 'Siti', 'P', '0000-00-00'],
            ['9130', 'Jawahir', 'L', '0000-00-00'],
            ['9131', 'Elok . J', 'P', '0000-00-00'],
            ['9132', 'Nuril', 'P', '0000-00-00'],
            ['9133', 'Sukenti', 'P', '0000-00-00'],
            ['9134', '', 'P', '0000-00-00'], // Kosong
            ['9135', 'Faridatul', 'P', '0000-00-00'],
            ['9136', 'Silvi Noo', 'P', '0000-00-00'],
            ['9137', 'Usmawati', 'P', '0000-00-00'],
            ['9138', 'Desi', 'P', '0000-00-00'],
            ['9139', 'Erna', 'P', '0000-00-00'],
            ['9140', '', 'P', '0000-00-00'], // Kosong
            ['9141', 'Khoiril', 'L', '0000-00-00'],
            ['9142', 'Sanati', 'P', '0000-00-00'],
            ['9143', 'Achmad', 'L', '0000-00-00'],
            ['9144', 'Riya', 'P', '0000-00-00'],
            ['9145', 'Ali Maksu', 'L', '0000-00-00'],
            ['9146', 'Arya', 'L', '0000-00-00'],
            ['9147', 'Robianto', 'L', '0000-00-00'],
            ['9148', '', 'L', '0000-00-00'],
            ['9149', '', 'L', '0000-00-00'],
            ['9150', 'Intan Puj', 'P', '0000-00-00'],
            ['9152', 'ernawati', 'P', '0000-00-00'],
            ['9153', 'Feri', 'L', '0000-00-00'],
            ['9155', 'Andri wa', 'L', '0000-00-00'],
            ['9157', 'Uswatun', 'P', '0000-00-00'],
            ['9160', 'Mudrika', 'P', '0000-00-00'],
            ['9161', 'Ripa', 'P', '0000-00-00'],
            ['9164', 'tasri', 'P', '0000-00-00'],
            ['9165', 'Mikah', 'P', '0000-00-00'],
            ['9166', 'Selvi', 'P', '0000-00-00'],
            ['9168', 'Raga', 'L', '0000-00-00'],
            ['9171', 'Nahru', 'L', '0000-00-00'],
            ['9172', 'Yudi', 'L', '0000-00-00'],
            ['9173', 'Toriq', 'L', '0000-00-00'],
            ['9174', 'Jayati', 'P', '0000-00-00'],
            ['9175', 'lastri', 'P', '0000-00-00'],
            ['9177', 'Miftahul', 'L', '0000-00-00'],
            ['9178', 'Anis', 'P', '0000-00-00'],
            ['9179', 'Nurul', 'P', '0000-00-00'],
            ['9180', 'khuzaima', 'P', '0000-00-00'],
            ['9182', 'Ida suwa', 'P', '0000-00-00'],
            ['9183', 'Carianto', 'L', '0000-00-00'],
            ['9184', 'Didin', 'L', '0000-00-00'],
            ['9185', 'Purwanto', 'L', '0000-00-00'],
            ['9186', 'Parlan', 'L', '0000-00-00'],
            ['9187', 'Warioto', 'L', '0000-00-00'],
            ['9188', 'Agus', 'L', '0000-00-00'],
            ['9190', 'Arif', 'L', '0000-00-00'],
            ['9191', 'Taufek', 'L', '0000-00-00'],
            ['9192', 'Andik', 'L', '0000-00-00'],
            ['9193', 'Muktar', 'L', '0000-00-00'],
            ['9198', 'Gunaidih', 'L', '0000-00-00'],
            ['9199', 'Susmiati', 'P', '0000-00-00'],
            ['9200', 'Wawang', 'L', '0000-00-00'],
            ['9201', 'Lusi suriy', 'P', '0000-00-00'],
            ['9203', 'Faujia', 'P', '0000-00-00'],
            ['9204', 'Kholifah', 'P', '0000-00-00'],
            ['9205', 'Meliya Su', 'P', '0000-00-00'],
            ['9210', 'Sayu', 'P', '0000-00-00'],
            ['9211', 'Kahar', 'L', '0000-00-00'],
            ['9212', 'Makmum', 'L', '0000-00-00'],
            ['9213', 'Faruq', 'L', '0000-00-00'],
            ['9222', 'Miftahul', 'L', '0000-00-00'],
            ['9232', 'Jahro', 'P', '0000-00-00'],
            ['9237', 'Niamah', 'P', '0000-00-00'],
            ['9240', 'Rudi', 'L', '0000-00-00'],
            ['9241', 'Uswatun', 'P', '0000-00-00'],
            ['9242', 'Dani', 'L', '0000-00-00'],
            ['9243', 'Sumaning', 'P', '0000-00-00'],
            ['9244', 'Fitroh', 'P', '0000-00-00'],
            ['9245', 'mifta', 'P', '0000-00-00'],
            ['9246', 'Rafael', 'L', '0000-00-00'],
            ['9247', 'Rio', 'L', '0000-00-00'],
            ['9248', 'Ganesa', 'L', '0000-00-00'],
            ['9249', 'Defa', 'L', '0000-00-00'],
            ['9250', 'Heri', 'L', '0000-00-00'],
            ['9251', 'Marsel', 'L', '0000-00-00'],
            ['9252', 'Farhan', 'L', '0000-00-00'],
            ['9001', '', 'L', '22/10/2025'],
            ['9002', 'Akmal', 'L', '2025-12-17'],
            ['9003', 'Ozen', 'L', '2025-05-10'],
            ['9004', '', 'P', '0000-00-00'],
            ['9005', 'soni', 'L', '2025-08-07'],
            ['9006', 'Fadhila', 'L', '2026-01-01'],
            ['9007', 'syahroni', 'L', '2025-10-01'],
            ['9008', 'Alfan', 'L', '15/10/2025'],
            ['9009', 'Harnum', 'P', '2025-11-28'],
            ['9010', 'Winda', 'L', '2026-01-01'],
            ['9011', 'Ayu', 'L', '0000-00-00'],
            ['9012', 'puji', 'P', '2025-09-11'],
            ['9013', 'yuli', 'P', '2025-07-11'],
            ['9014', 'aris', 'L', '22/10/2025'],
            ['9015', '', 'L', '0000-00-00'],
            ['9017', 'sendi', 'L', '2025-08-15'],
            ['9018', 'Nanik', 'P', '2025-12-03'],
            ['9019', 'Lailatul', 'P', '2025-12-18'],
            ['9020', 'lita', 'P', '2025-07-11'],
            ['9021', '', 'L', '2025-12-03'],
            ['9022', 'Fitriyah', 'P', '2025-12-24'],
            ['9023', '', 'P', '0000-00-00'],
            ['9024', 'arista', 'P', '2025-09-12'],
            ['9025', 'Suswati', 'P', '2025-07-16'],
            ['9026', 'hermiaseh', 'P', '2025-09-18'],
            ['9027', '', 'L', '0000-00-00'],
            ['9028', 'David', 'L', '15/10/2025'],
            ['9029', 'Kiswanto', 'L', '2025-12-06'],
            ['9030', 'Agus', 'L', '2025-12-10'],
            ['9031', 'Desi', 'P', '2025-06-19'],
            ['9032', 'ezzy', 'L', '06/11/2025'],
            ['9033', 'Nazil', 'L', '2025-12-10'],
            ['9034', '', 'P', '0000-00-00'],
            ['9253', 'Dayat', 'P', '0000-00-00']
        ];

        foreach ($dataMaster as $row) {
            $kode = trim($row[0]);
            $nama = trim($row[1]);
            $jkRaw = trim($row[2]);
            $tglRaw = trim($row[3]);

            // Jika nama kosong atau '-', simpan sebagai '-'
            if (empty($nama) || $nama === '-') {
                $nama = '-';
            }

            // Jenis Kelamin: 0=Laki, 1=Perempuan
            $jk = (strtoupper($jkRaw) === 'P') ? 1 : 0;

            // Logika Parsing Tanggal
            $tglMasuk = null;
            try {
                if (empty($tglRaw) || $tglRaw === '0000-00-00') {
                    $tglMasuk = now();
                } elseif (str_contains($tglRaw, '/')) {
                    $tglMasuk = Carbon::createFromFormat('d/m/Y', $tglRaw);
                } else {
                    $tglMasuk = Carbon::parse($tglRaw);
                }
            } catch (\Exception $e) {
                $tglMasuk = now();
            }

            // Update atau Create: Kode Pegawai jadi acuan unik
            Pegawai::updateOrCreate(
                ['kode_pegawai' => $kode],
                [
                    'nama_pegawai' => $nama,
                    'jenis_kelamin_pegawai' => $jk,
                    'tanggal_masuk' => $tglMasuk,
                    'alamat' => 'Malang',
                    'no_telepon_pegawai' => '0812000000',
                ]
            );
        }
    }
}
